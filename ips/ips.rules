# This Suricata rule drop sql injection attack and Nmap SYN scan
#
# see the demo video at https://www.youtube.com/watch?v=1Nclxir-qcw&t=37s
#
# https://github.com/alanshlam/Pentest
#
drop tcp any any -> $HOME_NET 80 (msg:"SQL injection attempt detected on 80"; flow:to_server,established; content:"' OR '1'='1'-- '"; nocase; classtype:attempted-user; sid:1000013; rev:1;)
drop tcp any any -> $HOME_NET 80 (msg:"SQL injection attempt detected on 80"; flow:to_server,established; content:"%27+OR+%271%27%3D%271"; nocase; classtype:attempted-user; sid:1000014; rev:1;)
drop tcp any any -> $HOME_NET any  (msg:"Nmap SYN scan detected"; flow:to_server; flags:S; window:1024;  reference:url,nmap.org/book/man-port-scanning-techniques.html; classtype:attempted-recon; sid:1000021; rev:1;)
